{"remainingRequest":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\src\\components\\MainSearch.vue?vue&type=style&index=0&id=a24b8b1e&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\src\\components\\MainSearch.vue","mtime":1621943402000},{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678861294792},{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\postcss-loader\\src\\index.js","mtime":1678861285044},{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678861295872},{"path":"C:\\Users\\ying123\\Desktop\\大创\\vue_project\\ucase\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi50aXRsZXsNCg0KfQ0K"},{"version":3,"sources":["MainSearch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgYA;;AAEA","file":"MainSearch.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <MySearch  style=\"margin-top: 35px\" @search=\"toSearch\" ></MySearch>\r\n    <div v-if=\"searched\" >\r\n      <el-table  :data.sync=\"tableData\"\r\n                 style=\"margin-left:20%;width: 70%;\" border stripe\r\n      ><el-table-column\r\n                        label=\"标题\"\r\n                        width=\"250\"\r\n                        header-align=\"center\"\r\n                        align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-link  @click=\"toCasedetail(scope.row.id)\">{{ scope.row.title }}</el-link >\r\n        </template>\r\n      </el-table-column>\r\n        <el-table-column prop=\"fname\"\r\n                         label=\"学科门类\" width=\"120\"\r\n                         header-align=\"center\"\r\n                         align=\"center\"\r\n                         >\r\n        </el-table-column>\r\n        <el-table-column prop=\"sname\"\r\n                         label=\"学科\"\r\n                         width=\"120\"\r\n                         header-align=\"center\"\r\n                         align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"kname\"\r\n                         label=\"类别\"\r\n                         width=\"120\"\r\n                         header-align=\"center\"\r\n                         align=\"center\"\r\n                         :filters=\"this.Kinds\"\r\n                         :filter-method=\"filterKind\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"author\"\r\n                         label=\"作者\"\r\n                         width=\"120\"\r\n                         header-align=\"center\"\r\n                         align=\"center\"\r\n        >\r\n        </el-table-column>\r\n        <el-table-column prop=\"checkerName\"\r\n                         label=\"审核人员\"\r\n                         width=\"120\"\r\n                         header-align=\"center\"\r\n                         align=\"center\"\r\n        >\r\n        </el-table-column>\r\n        <el-table-column header-align=\"center\"\r\n                         align=\"center\"\r\n                         label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"warning\" :icon=\"isCollect(scope.row)\"  circle :title=\"scope.row.collect===true?'取消收藏':'收藏'\" @click.prevent=\"collect(scope.row)\"></el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div style=\"text-align: center;margin-top: 30px;margin-right: 30%\">\r\n        <el-pagination\r\n            background\r\n            :page-size.sync=\"pagesize\"\r\n            :page-sizes.sync=\"pagesizes\"\r\n            layout=\"sizes, prev, pager, next, jumper, ->, total\"\r\n            :total.sync=\"total\"\r\n            @current-change=\"current_change\"\r\n            @size-change=\"changeSize\">\r\n        </el-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport MySearch from \"@/components/MySearch\";\r\nimport {request} from \"@/network/request\";\r\nimport {searchCasebypage,searchCasenum,collectCase,cancleCollect,getKinds} from \"@/api/api\";\r\nimport Vue from 'vue'\r\nexport default {\r\n  name: \"MainSearch\",\r\n  components:{\r\n    MySearch\r\n  },\r\n  methods:{\r\n    changeSize(){\r\n      this.currentPage=1\r\n      this.current_change(this.currentPage)\r\n    },\r\n    filterKind(value, row){\r\n      return row.kname === value\r\n    },\r\n    toCasedetail(id){\r\n      let routeUrl = this.$router.resolve({\r\n        path: \"/casedetail\",\r\n        query: {id:id}\r\n      });\r\n      window.open(routeUrl.href, '_blank')\r\n    },\r\n    current_change:function(currentPage){\r\n      const datas={\r\n        type:this.type,\r\n        value:this.value,\r\n        page:currentPage,\r\n        size:this.pagesize\r\n      }\r\n      const config={\r\n        url: searchCasebypage,\r\n        method: 'post',\r\n        data:datas\r\n      }\r\n      request(config).then((data)=>{\r\n        const collections=this.$store.state.collection\r\n        if(data.data.code===0){\r\n          this.tableData=data.data.data.map((i)=>{\r\n            Vue.set(i,'collect',false)\r\n            for(let j of collections){\r\n              if(i.id===j){\r\n                Vue.set(i,'collect',true)\r\n                break;\r\n              }\r\n            }\r\n            return i\r\n          })\r\n        }else{\r\n          alert(data.data.message)\r\n        }\r\n      }).catch(()=>{\r\n        alert(\"服务器开小差了\")\r\n      })\r\n      this.currentPage = currentPage;\r\n    },\r\n    // toSearch(item){\r\n    //   if(item.type==='subject'){\r\n    //     if(item.value.length>1){\r\n    //       item.value=item.value[0]+\";\"+item.value[1]\r\n    //     }\r\n    //     else{\r\n    //       item.value=item.value[0]\r\n    //     }\r\n    //   }\r\n    //   this.type=item.type\r\n    //   this.value=item.value\r\n    //   const datas={\r\n    //     type:item.type,\r\n    //     value:item.value,\r\n    //     page:1,\r\n    //     size:this.pagesize\r\n    //   }\r\n    //   const config={\r\n    //     url: searchCasebypage,\r\n    //     method: 'post',\r\n    //     data:datas\r\n    //   }\r\n    //   request(config).then((data)=>{\r\n    //       const collections=this.$store.state.collection\r\n    //       if(data.data.code===0){\r\n    //         this.tableData=data.data.data.map((i)=>{\r\n    //           Vue.set(i,'collect',false)\r\n    //           for(let j of collections){\r\n    //             if(i.id===j){\r\n    //               Vue.set(i,'collect',true)\r\n    //               break;\r\n    //             }\r\n    //           }\r\n    //           return i\r\n    //         })\r\n    //         const conf={\r\n    //           url: searchCasenum,\r\n    //           method: 'post',\r\n    //           data:datas\r\n    //         }\r\n    //         request(conf).then((data)=>{\r\n    //           this.total=data.data.data\r\n    //         }).catch(()=>{\r\n    //           alert(\"服务器开小差啦\");\r\n    //           this.total=this.tableData.length\r\n    //         })\r\n    //         this.total=this.tableData.length\r\n    //         this.searched=true\r\n    //       }else{\r\n    //         alert(data.data.message)\r\n    //       }\r\n    //   }).catch(()=>{\r\n    //     alert(\"服务器开小差了\")\r\n    //   })\r\n    // },\r\n    toSearch(item) {\r\n      if(item.value===undefined){\r\n        item.value=\"\"\r\n      }\r\n      if(item.type===\"kind\"||item.type===\"subject\"){\r\n        if(item.value===\"\"){\r\n          alert(\"检索不能为空\")\r\n        }else {\r\n          this.$router.push({\r\n            path: `/search/${item.type}/${item.value}`,\r\n          })\r\n        }\r\n      }else{\r\n        this.$router.push({\r\n          path: `/search/${item.type}/${item.value}`,\r\n        })\r\n      }\r\n    },\r\n    isCollect(item){\r\n      if(item.collect===true){\r\n        return 'el-icon-star-on'\r\n      }else {\r\n        return 'el-icon-star-off'\r\n      }\r\n    },\r\n    collect(row){\r\n      const token=this.$store.state.token\r\n      if(token===undefined||token===null||token===\"\"){\r\n        alert(\"请先登录\")\r\n        return\r\n      }\r\n      if(row.collect===false){\r\n        const config={\r\n          url: collectCase,\r\n          method: 'get',\r\n          headers:{\r\n            \"Token\":token\r\n          },\r\n          params:{\r\n            'cid':row.id\r\n          }\r\n        }\r\n        request(config).then((data)=> {\r\n          if (data.data.code === 0) {\r\n            for (let i in this.tableData) {\r\n              if (this.tableData[i].id === row.id) {\r\n                Vue.set(this.tableData[i], \"collect\", true)\r\n                break\r\n              }\r\n            }\r\n            this.$store.commit(\"addCollect\",row.id)\r\n            this.$notify({\r\n              title: 'tip',\r\n              message: '收藏成功',\r\n              duration: 2000\r\n            });\r\n          }else{\r\n            alert(data.data.message)\r\n          }\r\n        }).catch(()=>{\r\n          alert(\"服务器开小差了\")\r\n        })\r\n      }\r\n      //取消收藏\r\n      else{\r\n        const config0={\r\n          url: cancleCollect,\r\n          method: 'get',\r\n          headers:{\r\n            \"Token\":token\r\n          },\r\n          params:{\r\n            'cid':row.id\r\n          }\r\n        }\r\n        request(config0).then((data)=> {\r\n          if (data.data.code === 0) {\r\n            for (let i in this.tableData) {\r\n              if (this.tableData[i].id === row.id) {\r\n                Vue.set(this.tableData[i], \"collect\", false)\r\n                break\r\n              }\r\n            }\r\n            this.$store.commit(\"delCollect\",row.id)\r\n            this.$notify({\r\n              title: 'tip',\r\n              message: '取消收藏',\r\n              duration: 2000\r\n            });\r\n          }else{\r\n            alert(data.data.message)\r\n          }\r\n        }).catch(()=>{\r\n          alert(\"服务器开小差了\")\r\n        })\r\n      }\r\n    }\r\n  },\r\n  data(){\r\n    return {\r\n      type:\"\",\r\n      value:\"\",\r\n      searched:true,\r\n      tableData:[],\r\n      allData:[],\r\n      total: 0,\r\n      pagesize: 7,\r\n      pagesizes:[7,16,20],\r\n      currentPage:1,\r\n      Kinds:[]\r\n    }\r\n  },mounted() {\r\n    this.type=this.$route.params.type\r\n    this.value=this.$route.params.search\r\n    if(this.value===\"\"||this.value===undefined){\r\n      this.value=\"\"\r\n    }\r\n    const item={\r\n      type:this.type,\r\n      value:this.value\r\n    }\r\n    if(this.type===\"subject\"){\r\n      this.value=this.value.split(\",\")\r\n      item.value=this.value\r\n    }\r\n    const config={\r\n      url: getKinds,\r\n      method: 'get',\r\n    }\r\n    request(config).then((data)=>{\r\n      if(data.data.code===0){\r\n        this.Kinds=data.data.data.map((Kind)=>{\r\n          Vue.set(Kind,'text',Kind.name)\r\n          Vue.set(Kind,'value',Kind.name)\r\n          return Kind\r\n        })\r\n      }else{\r\n        alert(data.data.message)\r\n      }\r\n    }).catch(()=>{\r\n      alert(\"服务器开小差了\")\r\n    })\r\n      if(item.type==='subject'){\r\n        if(item.value.length>1){\r\n          item.value=item.value[0]+\";\"+item.value[1]\r\n        }\r\n        else{\r\n          item.value=item.value[0]\r\n        }\r\n      }\r\n      this.type=item.type\r\n      this.value=item.value\r\n      const datas={\r\n        type:item.type,\r\n        value:item.value,\r\n        page:1,\r\n        size:this.pagesize\r\n      }\r\n      const config0={\r\n        url: searchCasebypage,\r\n        method: 'post',\r\n        data:datas\r\n      }\r\n      request(config0).then((data)=>{\r\n        const collections=this.$store.state.collection\r\n        if(data.data.code===0){\r\n          this.tableData=data.data.data.map((i)=>{\r\n            Vue.set(i,'collect',false)\r\n            for(let j of collections){\r\n              if(i.id===j){\r\n                Vue.set(i,'collect',true)\r\n                break;\r\n              }\r\n            }\r\n            return i\r\n          })\r\n          const conf={\r\n            url: searchCasenum,\r\n            method: 'post',\r\n            data:datas\r\n          }\r\n          request(conf).then((data)=>{\r\n            this.total=data.data.data\r\n          }).catch(()=>{\r\n            alert(\"服务器开小差啦\");\r\n            this.total=this.tableData.length\r\n          })\r\n          this.total=this.tableData.length\r\n          this.searched=true\r\n        }else{\r\n          alert(data.data.message)\r\n        }\r\n      }).catch(()=>{\r\n        alert(\"服务器开小差了\")\r\n      })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.title{\r\n\r\n}\r\n</style>"]}]}